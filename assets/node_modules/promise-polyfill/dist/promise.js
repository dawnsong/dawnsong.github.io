!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Promise=e()}(this,(function(){"use strict";function t(){}function e(t,e){return function(){t.apply(e,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,n._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(t){return void i(e.promise,t)}r(e.promise,o)}else(1===t._state?r:i)(e.promise,t._value)}))):t._deferreds.push(e)}function r(t,o){try{if(o===t)throw new TypeError("A promise cannot be resolved with itself.");if(o&&("object"==typeof o||"function"==typeof o)){var r=o.then;if(o instanceof n)return t._state=3,t._value=o,void f(t);if("function"==typeof r)return void c(e(r,o),t)}t._state=1,t._value=o,f(t)}catch(e){i(t,e)}}function i(t,e){t._state=2,t._value=e,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&n._immediateFn((function(){t._handled||n._unhandledRejectionFn(t._value)}));for(var e=0,r=t._deferreds.length;e<r;e++)o(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t((function(t){n||(n=!0,r(e,t))}),(function(t){n||(n=!0,i(e,t))}))}catch(t){if(n)return;n=!0,i(e,t)}}var s=setTimeout;return n.prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(e,n){var r=new this.constructor(t);return o(this,new u(e,n,r)),r},n.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},n.all=function(t){return new n((function(e,n){function o(t,f){try{if(f&&("object"==typeof f||"function"==typeof f)){var u=f.then;if("function"==typeof u)return void u.call(f,(function(e){o(t,e)}),n)}r[t]=f,0==--i&&e(r)}catch(t){n(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);for(var i=r.length,f=0;f<r.length;f++)o(f,r[f])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(e){e(t)}))},n.reject=function(t){return new n((function(e,n){n(t)}))},n.race=function(t){return new n((function(e,n){for(var o=0,r=t.length;o<r;o++)t[o].then(e,n)}))},n._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){s(t,0)},n._unhandledRejectionFn=function(){"undefined"!=typeof console&&console},n}));